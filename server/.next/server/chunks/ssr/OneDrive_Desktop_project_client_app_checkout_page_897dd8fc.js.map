{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usman/OneDrive/Desktop/project/client/app/checkout/page.js"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect, useContext } from \"react\";\r\nimport Image from \"next/image\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport axios from \"axios\";\r\nimport CustomToaster, { showToast } from \"@/app/components/CustomToaster\";\r\nimport { AppContext } from \"../context/AppContext\";\r\n\r\nexport default function CheckoutPage() {\r\n  const { userData} = useContext(AppContext);\r\n  const router = useRouter();\r\n\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [street, setStreet] = useState(\"\");\r\n  const [city, setCity] = useState(\"\");\r\n  const [country, setCountry] = useState(\"\");\r\n\r\n\r\n\r\n  // ðŸ›’ Load cart\r\n  useEffect(() => {\r\n    const savedCart = JSON.parse(localStorage.getItem(\"cart\")) || [];\r\n    setCartItems(savedCart);\r\n  }, []);\r\n\r\n  const subtotal = cartItems.reduce(\r\n    (acc, item) => acc + item.price * item.quantity,\r\n    0\r\n  );\r\n  const deliveryCharges = 150;\r\n  const total = subtotal + deliveryCharges;\r\n\r\n  const handleOrder = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!street || !city || !country) {\r\n      showToast(\"error\", \"Please fill all required fields\");\r\n      return;\r\n    }\r\n\r\n    if (cartItems.length === 0) {\r\n      showToast(\"error\", \"Your cart is empty\");\r\n      return;\r\n    }\r\n\r\n    if (!userData?.email) {\r\n      showToast(\"error\", \"User email not found\");\r\n      return;\r\n    }\r\n\r\n    const orderData = {\r\n      userEmail: userData.email,\r\n      items: cartItems.map((item) => ({\r\n        product: item._id,\r\n        quantity: item.quantity,\r\n        priceAtPurchase: item.price,\r\n      })),\r\n      totalAmount: total,\r\n      shippingAddress: {\r\n        street,\r\n        city,\r\n        country,\r\n      },\r\n    };\r\n\r\n    try {\r\n      const res = await axios.post(\r\n        \"http://localhost:5000/api/orders\",\r\n        orderData,\r\n        { withCredentials: true }\r\n      );\r\n\r\n      showToast(\"success\", \"Order placed successfully ðŸŽ‰\");\r\n\r\n      localStorage.removeItem(\"cart\");\r\n      setCartItems([]);\r\n\r\n      setTimeout(() => router.push(\"/\"), 2000);\r\n    } catch (error) {\r\n      showToast(\r\n        \"error\",\r\n        error.response?.data?.message || \"Failed to place order\"\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <CustomToaster />\r\n      <div className=\"min-h-screen bg-gray flex flex-col items-center justify-center mt-10 py-10 px-4\">\r\n        <div className=\"w-full md:w-2/3 bg-neutral shadow-lg rounded-2xl p-6 sm:p-8 grid sm:grid-cols-2 gap-8\">\r\n\r\n          {/* ORDER SUMMARY */}\r\n          <div>\r\n            <h2 className=\"text-xl font-semibold mb-4 text-yellow text-center\">\r\n              Order Summary\r\n            </h2>\r\n\r\n            <div className=\"space-y-4 max-h-72 overflow-y-auto pr-2 scrollbar-hide\">\r\n              {cartItems.map((item, i) => (\r\n                <div\r\n                  key={i}\r\n                  className=\"flex items-center justify-between bg-gray rounded-lg p-3\"\r\n                >\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-16 h-16 relative\">\r\n                      <Image\r\n                        src={\r\n                          item?.mediaRef?.filePath\r\n                            ? `http://localhost:5000${item.mediaRef.filePath}`\r\n                            : \"/burger.png\"\r\n                        }\r\n                        alt={item.name}\r\n                        fill\r\n                        className=\"object-cover rounded-md\"\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-medium\">{item.name}</p>\r\n                      <p className=\"text-yellow-600 font-bold text-sm\">\r\n                        Rs {item.price}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <span className=\"font-bold\">x{item.quantity}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {/* TOTAL */}\r\n            <div className=\"mt-6 border-t pt-4 space-y-2\">\r\n              <div className=\"flex justify-between\">\r\n                <span>Subtotal</span>\r\n                <span>Rs {subtotal}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>Delivery Charges</span>\r\n                <span>Rs {deliveryCharges}</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-lg font-semibold border-t pt-3\">\r\n                <span className=\"text-yellow-600\">Total</span>\r\n                <span className=\"text-yellow-600\">Rs {total}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* CONTACT & DELIVERY */}\r\n          <div>\r\n            <h2 className=\"text-xl font-semibold mb-4 text-yellow text-center\">\r\n              Contact & Delivery\r\n            </h2>\r\n\r\n            <form onSubmit={handleOrder} className=\"space-y-4\">\r\n              {/* EMAIL (READ ONLY) */}\r\n              <input\r\n                type=\"email\"\r\n                value={userData?.email || \"\"}\r\n                readOnly\r\n                className=\"w-full p-3 rounded-md bg-gray opacity-70 cursor-not-allowed\"\r\n              />\r\n\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Street*\"\r\n                value={street}\r\n                onChange={(e) => setStreet(e.target.value)}\r\n                className=\"w-full p-3 rounded-md bg-gray\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"City*\"\r\n                value={city}\r\n                onChange={(e) => setCity(e.target.value)}\r\n                className=\"w-full p-3 rounded-md bg-gray\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Country*\"\r\n                value={country}\r\n                onChange={(e) => setCountry(e.target.value)}\r\n                className=\"w-full p-3 rounded-md bg-gray\"\r\n              />\r\n\r\n              <button\r\n                type=\"submit\"\r\n                className=\"bg-yellow w-full font-bold text-lg rounded-sm p-3\"\r\n              >\r\n                Confirm Order\r\n              </button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}
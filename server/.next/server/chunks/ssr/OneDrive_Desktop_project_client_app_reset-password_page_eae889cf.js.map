{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usman/OneDrive/Desktop/project/client/app/reset-password/page.js"],"sourcesContent":["'use client';\r\nimport { useState, useContext, useRef, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport axios from 'axios';\r\nimport { AppContext } from '../context/AppContext';\r\nimport { showToast } from \"../components/CustomToaster\";\r\n\r\nexport default function ResetPassword() {\r\n  // Handle OTP input focus\r\n  const handleInput = (e, index) => {\r\n    if (e.target.value.length > 0 && index < inputRefs.current.length - 1) {\r\n      inputRefs.current[index + 1].focus();\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e, index) => {\r\n    if (e.key === 'Backspace' && e.target.value === '' && index > 0) {\r\n      inputRefs.current[index - 1].focus();\r\n    }\r\n  };\r\n\r\n  const handlePaste = (e) => {\r\n    const paste = e.clipboardData.getData('text');\r\n    const pasteArray = paste.split('');\r\n    pasteArray.forEach((char, index) => {\r\n      if (inputRefs.current[index]) inputRefs.current[index].value = char;\r\n    });\r\n    if (inputRefs.current[5]) inputRefs.current[5].focus();\r\n  };\r\n\r\n\r\n  const router = useRouter();\r\n  const { backendUrl } = useContext(AppContext);\r\n\r\n  // shared states\r\n  const [email, setEmail] = useState('');\r\n  const [otp, setOtp] = useState('');\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  // flow states\r\n  const [isOtpSent, setIsOtpSent] = useState(false);\r\n  const [isOtpSubmitted, setIsOtpSubmitted] = useState(false);\r\n\r\n  // timer\r\n  const [timer, setTimer] = useState(120);\r\n\r\n  // refs\r\n  const emailRef = useRef(null);\r\n  const newPasswordRef = useRef(null);\r\n  const inputRefs = useRef([]);\r\n\r\n  /* ---------------- TIMER ---------------- */\r\n  useEffect(() => {\r\n    if (!isOtpSent) return;\r\n\r\n    const interval = setInterval(() => {\r\n      setTimer(prev => {\r\n        if (prev <= 1) {\r\n          clearInterval(interval);\r\n          return 0;\r\n        }\r\n        return prev - 1;\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isOtpSent]);\r\n\r\n\r\n  /* ---------------- SEND OTP ---------------- */\r\n  const handleSendOtp = async (e) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n\r\n    try {\r\n      const { data } = await axios.post(\r\n        `${backendUrl}/api/auth/send-reset-otp`,\r\n        { email },\r\n        { withCredentials: true }\r\n      );\r\n\r\n      if (data.success) {\r\n        showToast(\"success\", data.message);\r\n        setIsOtpSent(true);\r\n        setTimer(120);\r\n      } else {\r\n        showToast(\"error\", data.message);\r\n      }\r\n    } catch (err) {\r\n      showToast(\"error\", err.response?.data?.message || \"Something went wrong\");\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  /* ---------------- VERIFY OTP ---------------- */\r\n  const handleSubmitOtp = (e) => {\r\n    e.preventDefault();\r\n    const otpValue = inputRefs.current.map(i => i?.value || '').join('');\r\n\r\n    if (otpValue.length !== 6) {\r\n      showToast(\"error\", \"Please enter complete OTP\");\r\n      return;\r\n    }\r\n\r\n    setOtp(otpValue);\r\n    setIsOtpSubmitted(true);\r\n  };\r\n\r\n\r\n\r\n  /* ---------------- RESET PASSWORD ---------------- */\r\n  const handleResetPassword = async (e) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n\r\n    try {\r\n      const { data } = await axios.post(\r\n        `${backendUrl}/api/auth/reset-password`,\r\n        { email, otp, newPassword },\r\n        { withCredentials: true }\r\n      );\r\n\r\n      if (data.success) {\r\n        showToast(\"success\", data.message);\r\n        router.push('/');\r\n      } else {\r\n        showToast(\"error\", data.message);\r\n      }\r\n    } catch (err) {\r\n      showToast(\"error\", err.response?.data?.message || \"Something went wrong\");\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center h-screen bg-gray overflow-hidden \" >\r\n\r\n      <div className={`flex flex-col md:flex-row w-full md:w-2/3 h-3/4 md:h-2/3 bg-neutral  rounded-3xl overflow-hidden`}>\r\n        {/* !isOtpSent */}\r\n        {!isOtpSent && (\r\n          <>\r\n            <div className=\"flex flex-col items-center justify-center gap-4 w-full md:w-1/2 h-2/5 md:h-full bg-yellow rounded-b-[120px] md:rounded-l-none md:rounded-r-[120px] text-center\">\r\n\r\n              <i className=\"ri-lock-unlock-fill text-8xl\"></i>\r\n              <h1 className='text-xl font-bold'>Forgot your password?</h1>\r\n              <p className='w-1/2'>Enter your registered email to receive a verification code.</p>\r\n\r\n            </div>\r\n\r\n\r\n            <div className=\"flex flex-col items-center justify-center gap-4 order-2 md:order-1 w-full md:w-1/2 h-3/5 md:h-full px-4 md:p-12\">\r\n\r\n\r\n              {/* Step 1: Enter email */}\r\n              <form className='flex flex-col gap-3\r\n                        \r\n                        rounded-2xl  p-8  w-sm text-center'\r\n                onSubmit={handleSendOtp}\r\n              >\r\n                <h1 className='text-lg font-bold' >\r\n                  Reset Password\r\n                </h1>\r\n\r\n\r\n                <div className=\"relative p-2 bg-gray rounded-t-md\">\r\n                  <input\r\n                    ref={emailRef}\r\n                    type=\"email\"\r\n                    className=\"pt-6 w-full bg-transparent outline-none peer\"\r\n                    value={email}\r\n                    disabled={submitting}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                    required\r\n                  />\r\n                  <label\r\n                    onClick={() => emailRef.current.focus()}\r\n                    className={`absolute left-2 text-yellow text-lg uppercase cursor-text transition-all duration-300\r\n                    ${email ? \"top-1 text-sm\" : \"top-5 peer-focus:top-1 peer-focus:text-sm\"}`}>\r\n                    email*\r\n                  </label>\r\n                  <span className=\"absolute left-0 bottom-0 w-0 h-0.5 bg-red peer-focus:w-full transition-all duration-300\" />\r\n                </div>\r\n\r\n                <button disabled={submitting}\r\n                  className='w-full px-4 py-3 bg-red rounded-md font-bold uppercase flex items-center justify-center gap-2' >\r\n                  {submitting && <div className=\"w-6 h-6 border-t-2 border-t-blue-400 rounded-full animate-spin\"></div>}\r\n                  {submitting ? \"Sending...\" : \"Send OTP\"}\r\n                </button>\r\n              </form>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n\r\n        {isOtpSent && !isOtpSubmitted && (\r\n          <>\r\n            <div className=\"flex flex-col items-center justify-center gap-4 w-full md:w-1/2 h-2/5 md:h-full bg-yellow rounded-b-[120px] md:rounded-l-none md:rounded-r-[120px] text-center\">\r\n\r\n              <i className=\"ri-lock-unlock-fill text-8xl\"></i>\r\n              <h1 className='text-xl font-bold'>Verify your email</h1>\r\n              <p className='w-2/3'>We have sent a 6-digit verification code to your email. Enter the verification code to continue.</p>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col items-center justify-center gap-4 order-2 md:order-1 w-full md:w-1/2 h-3/5 md:h-full px-4 md:p-12\">\r\n\r\n              <form className='flex flex-col gap-3 rounded-2xl  p-8  w-sm text-center'\r\n                onSubmit={handleSubmitOtp}\r\n              >\r\n                <h1 className='text-lg font-bold'>\r\n                  Password Reset OTP\r\n                </h1>\r\n\r\n\r\n                <div className=\"flex justify-center gap-4\" onPaste={handlePaste}>\r\n                  {Array(6)\r\n                    .fill(0)\r\n                    .map((_, index) => (\r\n                      <input\r\n                        key={index}\r\n                        type=\"text\"\r\n                        maxLength={1}\r\n                        required\r\n                        ref={(el) => (inputRefs.current[index] = el)}\r\n                        onInput={(e) => handleInput(e, index)}\r\n                        onKeyDown={(e) => handleKeyDown(e, index)}\r\n                        className=\"w-11 h-11 bg-transparent border-2 border-gray \r\n                      outline-none focus:border-yellow  rounded-md text-2xl \r\n                      text-center font-semibold transition-all\"\r\n                      />\r\n                    ))}\r\n                </div>\r\n\r\n                <button disabled={submitting}\r\n                  className=\"w-full px-1 py-2 bg-red-500\r\n                        font-bold text-lg uppercase rounded cursor-pointer\" >\r\n                  Submit OTP\r\n                </button>\r\n\r\n                {timer > 0 ? (\r\n                  <div className=\"font-medium\">\r\n                    Resend in {Math.floor(timer / 60)}:{String(timer % 60).padStart(2, '0')}\r\n                  </div>\r\n                ) : (\r\n                  <button\r\n                    onClick={handleSendOtp}\r\n                    disabled={submitting}\r\n                    className=\"text-center underline text-red-300 font-medium\"\r\n                  >\r\n                    {submitting ? \"Resending...\" : \"Resend OTP\"}\r\n                  </button>\r\n                )}\r\n              </form>\r\n\r\n\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {isOtpSent && isOtpSubmitted && (\r\n          <>\r\n            <div className=\"flex flex-col items-center justify-center gap-4 w-full md:w-1/2 h-2/5 md:h-full bg-yellow rounded-b-[120px] md:rounded-l-none md:rounded-r-[120px] text-center\">\r\n\r\n              <i className=\"ri-lock-unlock-fill text-8xl\"></i>\r\n              <h1 className='text-xl font-bold'>Create new password</h1>\r\n              <p className='w-2/3'>Use at least 6 characters to create a strong password.</p>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col items-center justify-center gap-4 order-2 md:order-1 w-full md:w-1/2 h-3/5 md:h-full px-4 md:p-12\">\r\n\r\n              <form className='flex flex-col gap-3 rounded-2xl  p-8  w-sm text-center'\r\n                onSubmit={handleResetPassword}\r\n              >\r\n                <h1 className='text-lg font-bold'>\r\n                  New Password\r\n                </h1>\r\n\r\n\r\n                <div className=\"relative p-2 bg-gray rounded-t-md\">\r\n                  <input\r\n                    ref={newPasswordRef}\r\n                    type=\"password\"\r\n                    className=\"pt-6 w-full bg-transparent outline-none peer\"\r\n                    value={newPassword}\r\n                    onChange={(e) => setNewPassword(e.target.value)}\r\n                    required\r\n                    disabled={submitting}\r\n                  />\r\n                  <label\r\n                    onClick={() => newPasswordRef.current.focus()}\r\n                    className={`absolute left-2 text-yellow text-lg uppercase cursor-text transition-all duration-300\r\n                    ${newPassword ? \"top-1 text-sm\" : \"top-5 peer-focus:top-1 peer-focus:text-sm\"}`}>\r\n                    new Password*\r\n                  </label>\r\n                  <span className=\"absolute left-0 bottom-0 w-0 h-0.5 bg-red peer-focus:w-full transition-all duration-300\" />\r\n                </div>\r\n\r\n                <button disabled={submitting}\r\n                  className=\"cursor-pointer w-full px-4 py-3 bg-red rounded-md font-bold uppercase flex items-center justify-center gap-2\" >\r\n                  {submitting && <div className=\"w-6 h-6 border-t-2 border-t-blue-400 rounded-full animate-spin\"></div>}\r\n                  {submitting ? \"Resetting...\" : \"Reset Password\"}\r\n                </button>\r\n              </form>\r\n\r\n\r\n\r\n\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}